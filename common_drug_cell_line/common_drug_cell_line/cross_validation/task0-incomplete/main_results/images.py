ccle_gdsc_our_method_mae=[0.08695411418941361, 0.0916581780453893, 0.08865606635422661, 0.08998799084244602, 0.09067305163596122, 0.08985990159019976, 0.09557773109709825, 0.08585861315084806, 0.08918172401334142, 0.09065094012001543]
ccle_gdsc_our_method_mse=[0.01611450313683322, 0.01722014285383788, 0.0158504652298073, 0.015590094878150707, 0.01595141989276142, 0.016247596474154448, 0.019909749376602025, 0.01505203633737609, 0.01622700916266278, 0.01685823100679735]
ccle_gdsc_our_method_r2=[0.5568359021584979, 0.47543655201645296, 0.5263144649634056, 0.4613049556266575, 0.4977826204493866, 0.48747087944158296, 0.4977913977002911, 0.5681530278429201, 0.48719882306433693, 0.4850427298744966]



ccle_gdsc_combined_dataset_mae=[0.10494072971566162, 0.1054787515513821, 0.10749936694262581, 0.1056678092178499, 0.11083690534976871, 0.1018498117429481, 0.11445204087806617, 0.11026946732105922, 0.10369137169919392, 0.10757213324705588]
ccle_gdsc_combined_dataset_mse=[0.024914191425371747, 0.023140510117438257, 0.024747929214929337, 0.02242213584551539, 0.02485106371226304, 0.02274507726133391, 0.02897883026137858, 0.025708463119569366, 0.023053044580037072, 0.02509283326480446]
ccle_gdsc_combined_dataset_r2=[0.3148361402941078, 0.2950891361161846, 0.2604169075632813, 0.22523284440217628, 0.21758463005029038, 0.2825083719718985, 0.2690305856410907, 0.26241727642989865, 0.27148445692666123, 0.23350576270143641]


ccle_gdsc_selected_best_mae=[0.1039382026653871, 0.10643200616142531, 0.10496980268471928, 0.10185158498787161, 0.10669024281523394, 0.1024814432581326, 0.11667468772582554, 0.10652137469029975, 0.10193166645458353, 0.1055220913455225]
ccle_gdsc_selected_best_mse=[0.03647582991630795, 0.03272410118963445, 0.03347518461929496, 0.029244171311894985, 0.032420135446546504, 0.030469521301533097, 0.04201926905951029, 0.03548386562135264, 0.030741629166644878, 0.032106718085360336]
ccle_gdsc_selected_best_r2=[-0.0031198678991564144, 0.003151861288342328, -0.0003940267330742042, -0.010493540010552804, -0.020721388948523378, 0.038841407628975366, -0.059904772524745464, -0.018041651345168663, 0.028512065313436863, 0.019257246429958297]



ccle_gdsc_weighted_average_mae=[0.10027124318932275, 0.10130038031907188, 0.10216096387508343, 0.09963949734570166, 0.10435904936729246, 0.09571961896444604, 0.1083089264918877, 0.10277726441551287, 0.09946793116836637, 0.10268519873575993]
ccle_gdsc_weighted_average_mse=[0.022854663837647553, 0.021375497601479946, 0.022028827762953, 0.020266974371129565, 0.022073371373046127, 0.02014415779351003, 0.026053654749511587, 0.02226875631365293, 0.02103690047085921, 0.02234138314827052]
ccle_gdsc_weighted_average_r2=[0.3714750994753737, 0.34885530164476275, 0.34167629064284355, 0.2997015897914733, 0.3050379964074992, 0.3645541668442389, 0.34281595970624523, 0.36110339011902204, 0.33519805083016374, 0.31755249573798816]



ccle_gdsc_model_average_mae=[0.09911027603367574, 0.10164072738120385, 0.10183515909515108, 0.09934906196076089, 0.10410879618882171, 0.0971320487719532, 0.10803650800890695, 0.10194752657200692, 0.10064816820132093, 0.10244442320329053]
ccle_gdsc_model_average_mse=[0.02252806765760934, 0.021476813706088192, 0.022162908583529074, 0.02002070153531529, 0.02212598892256674, 0.020389578910825292, 0.025891224901972112, 0.0219352058825539, 0.02134679713517806, 0.02219297476124862]
ccle_gdsc_model_average_r2=[0.38045680373619506, 0.3457689901303539, 0.3376693328462176, 0.30821122089082276, 0.30338137599274784, 0.35681237748947825, 0.34691313165761195, 0.3706730417265012, 0.3254047874753371, 0.3220858289099985]



ccle_gcsi_our_method_mae=[0.10348528176255219, 0.09223059358160807, 0.0935885495331036, 0.09404098776569114, 0.09278845291418235, 0.09273817991008082, 0.10231546838036956, 0.09253320682358902, 0.09864694455436673, 0.0956248566608895]
ccle_gcsi_our_method_mse=[0.020189009462091827, 0.016172554839090213, 0.01739268913330956, 0.015680570047864245, 0.016098993139667155, 0.01664241980096826, 0.019613947440636013, 0.016262537021126646, 0.017617181313562203, 0.015613401809037817]
ccle_gcsi_our_method_r2=[0.6175983558832239, 0.6621376465169126, 0.6851573445582531, 0.6761952574254118, 0.6998530402892422, 0.7219228851922361, 0.6108082686306098, 0.6563013036350684, 0.6648413779717018, 0.6636549870846019]



ccle_gcsi_combined_dataset_mae=[0.12205601841309921, 0.09845937803436793, 0.10998469457963303, 0.10398384654292006, 0.1009867427174397, 0.10001490743558944, 0.11621340085582202, 0.10615328975176395, 0.11480542452629128, 0.09993066557946077]
ccle_gcsi_combined_dataset_mse=[0.04702262326660747, 0.018819639148461416, 0.03579792020914469, 0.023917384581359037, 0.021592006013400975, 0.020327853269939675, 0.026184344821195814, 0.02416542656128086, 0.03729213685231483, 0.01800351060913754]
ccle_gcsi_combined_dataset_r2=[0.10934072909333492, 0.6068371610011302, 0.35198564341877314, 0.5061045272088669, 0.5974422187304137, 0.6603432160020675, 0.4804344955762829, 0.4892786042285474, 0.2905345652377068, 0.6121670932181025]



ccle_gcsi_selected_best_mae=[0.10928136073773466, 0.10130548327269435, 0.10221525058501844, 0.09900379227234063, 0.10746235280316813, 0.10072429503401853, 0.10863568898814877, 0.11250720538795184, 0.10349246827587566, 0.10194847152930077]
ccle_gcsi_selected_best_mse=[0.026039249074229324, 0.02101482832174609, 0.022455848132355793, 0.019797464596605224, 0.02484781971143656, 0.020984418341653523, 0.02662463091090267, 0.02659773717185278, 0.021071808988924686, 0.020017131298806116]
ccle_gcsi_selected_best_r2=[0.506788499146118, 0.5609772589753921, 0.5935039830817601, 0.5911811300376533, 0.5367413677907242, 0.6493727127333591, 0.4716980744112167, 0.43787321865296747, 0.599118704708189, 0.5687895330197061]



ccle_gcsi_weighted_average_mae=[0.0996263381641745, 0.09124419569241721, 0.09634218087168575, 0.09337280969813001, 0.0934252864394043, 0.09128474582785603, 0.10352050928025314, 0.09447445293520947, 0.09761111543812721, 0.09166141321525773]
ccle_gcsi_weighted_average_mse=[0.020329276164634966, 0.01631940700771646, 0.0191685688260614, 0.015790088668696356, 0.017640893368458196, 0.016775047308356553, 0.0204900889451219, 0.017630085421470643, 0.017776697072806397, 0.015123780172762481]
ccle_gcsi_weighted_average_r2=[0.6149415530436368, 0.6590697441477562, 0.6530103502708511, 0.6739336911228209, 0.6711061079914302, 0.7197068207593142, 0.5934233424148401, 0.627399011095868, 0.6618066653744645, 0.6742024512177135]



ccle_gcsi_model_average_mae=[0.09737590298552071, 0.09083195712934197, 0.09275084588754884, 0.09209921757847576, 0.0951711683612694, 0.09138633089916162, 0.10013981567853861, 0.09337482792198903, 0.09322135474012977, 0.09144692946062731]
ccle_gcsi_model_average_mse=[0.01928667786909177, 0.01631427791873159, 0.018204328736642565, 0.015690275620773977, 0.018082390265749624, 0.017123473108448962, 0.019384436556195216, 0.01725489498782842, 0.016878552278446278, 0.01493123375641444]
ccle_gcsi_model_average_r2=[0.6346894908073828, 0.6591768964247399, 0.6704650352772429, 0.6759948367437667, 0.6628749130158111, 0.7138849966271861, 0.6153623615154808, 0.6353284296585378, 0.6788934493668557, 0.6783502998214629]



gdsc_gcsi_our_method_mae=[0.08379067090907578, 0.08774115488303427, 0.07315509908219545, 0.07938220261034372, 0.0841795070559512, 0.07757656419547433, 0.08029584750207251, 0.08213002851588548, 0.08300374160788844, 0.07614101205676678]
gdsc_gcsi_our_method_mse=[0.01367407988953268, 0.014729417556875908, 0.00926182003192237, 0.01104433596788723, 0.013945016934150964, 0.010345549574783862, 0.01218347806786905, 0.013153511005143005, 0.01269511059016791, 0.01143933257180961]
gdsc_gcsi_our_method_r2=[0.4608302366833149, 0.5017570727549125, 0.5180992058195155, 0.5040095542391395, 0.4907520939564234, 0.5388418079758361, 0.49928241731972156, 0.5060508499206946, 0.47714366538439446, 0.536828823299962]



gdsc_gcsi_combined_dataset_mae=[0.09484003778826945, 0.09767140969714343, 0.08506039525057353, 0.0931755151257722, 0.10028342953095382, 0.09118846947663048, 0.09441078522962083, 0.09400210262039443, 0.09945084200028907, 0.09116890580339185]
gdsc_gcsi_combined_dataset_mse=[0.017406741390865947, 0.01834837571192376, 0.013233509956858812, 0.015693652899495137, 0.01921487129362593, 0.014641663718830054, 0.016604738800896916, 0.01722383774648622, 0.018363668369222264, 0.01587362335549716]
gdsc_gcsi_combined_dataset_r2=[0.3136511771433944, 0.37934080627417865, 0.3114486206787199, 0.2952132278600116, 0.29830612487731645, 0.34734031092374074, 0.3175770804439313, 0.3531993083326399, 0.2436804496162256, 0.35728725763449265]


gdsc_gcsi_selected_best_mae=[0.09883611823489111, 0.10644801153078064, 0.09179599356173125, 0.10183839633583208, 0.10763766471638982, 0.10143182297610948, 0.10110245678016436, 0.10192958131800833, 0.10628846801216367, 0.09382578395446861]
gdsc_gcsi_selected_best_mse=[0.020808451452577807, 0.023503797300675148, 0.017051817380515304, 0.020750259378475362, 0.02395036937254761, 0.020632898810229436, 0.022111822446980445, 0.02154995984721422, 0.023704611806810133, 0.019837807733931144]
gdsc_gcsi_selected_best_r2=[0.1795215520671839, 0.20495153842679348, 0.11277866449912588, 0.0681259218563679, 0.12537392320616292, 0.08027792600455319, 0.09124650427149539, 0.1907419740164732, 0.023710242241330226, 0.19677999624583964]



gdsc_gcsi_weighted_average_mae=[0.09193469874658436, 0.09725365511643487, 0.08307289796145675, 0.09160408841054071, 0.09930539747370916, 0.08947884642419315, 0.09199301124362409, 0.09222812486656089, 0.09726206193302012, 0.08856467763559671]
gdsc_gcsi_weighted_average_mse=[0.016245801488349604, 0.017946837268988023, 0.012504601053732902, 0.014823186077639511, 0.01869806092964787, 0.013968037142691105, 0.015795629479201583, 0.016754304685502052, 0.017337191102263984, 0.015108860232932658]
gdsc_gcsi_weighted_average_r2=[0.35942710484905194, 0.3929233996413103, 0.34937440395791564, 0.3343050508765839, 0.31717914575066597, 0.37736756193695287, 0.35082992182687023, 0.37083151743001186, 0.2859565792770191, 0.3882520218068277]


gdsc_gcsi_model_average_mae=[0.092209541124946, 0.09606871307922037, 0.08317398911804198, 0.09198140972233819, 0.09864522292574421, 0.09013277253163407, 0.0919117472092784, 0.0923991421080598, 0.09797115045948279, 0.08883558530688375]
gdsc_gcsi_model_average_mse=[0.016346323273564382, 0.01764932623418281, 0.012694608798585187, 0.014822037724464315, 0.01855827983613349, 0.014106931549290287, 0.01601137133527503, 0.01673870119926924, 0.017542976952506978, 0.015301693361063245]
gdsc_gcsi_model_average_r2=[0.3554635250264774, 0.40298712200485143, 0.33948813076008133, 0.3343566223069454, 0.32228370958969266, 0.37117627234266504, 0.3419633452996844, 0.3714174696339486, 0.27748115603359025, 0.38044433317619075]


methods={
        0:our_method_mae,
        1:combined_dataset_mae, 
        2:selected_best_mae,
        3:weighted_average_mae,
        4:model_average_mae,
        }

names={
        0:"Our Method",
        1:"Combined Dataset", 
        2:"Selecting Best",
        3:"Result Averaging",
        4:"Model Averaging",
        }


# import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

for counter in range(len(methods)):
    ax = plt.subplot(3, 2, counter + 1)
    main=ax.boxplot(methods[counter], patch_artist=True)
    m = np.array(methods[counter]).mean(axis=0)
    st = np.array(methods[counter]).std(axis=0)
    ax.set_title(names[counter])
    for i, line in enumerate(main['medians']):
        x, y = line.get_xydata()[1]
        text = ' μ={:.2f}\n σ={:.2f}'.format(m[i], st[i])
        ax.annotate(text, xy=(x, y))
    ax.set_xticks([1, 2,3,4, 5])
    ax.set_xticklabels(["50 genes","100 genes", "200 genes", "500 genes",'902 genes'], rotation=10)
    # ax.set_ylim(-20,10)

    colors=["forestgreen", "blue", "dimgray",  "slategray", "tomato"]
     
    for patch, color in zip(main['boxes'],colors):
        patch.set_facecolor(color)
plt.tight_layout()
plt.suptitle("MAE score comparison between different number of genes")
plt.savefig('Mae.png')
plt.show()

