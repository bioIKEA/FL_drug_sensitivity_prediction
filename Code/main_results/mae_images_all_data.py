##all the calculations are for our methods only

CCLE_GDSC=[[0.08862282551008656, 0.09205313974437195, 0.09073155491053839, 0.09044950217754473, 0.08999903510718579, 0.0921505597174794, 0.09697359666629869, 0.08832405500187171, 0.09109152025622125, 0.09379671289892162], [0.08816447597874805, 0.0922458847201788, 0.09057806439323297, 0.09032153446804278, 0.0894808878064025, 0.09196075301706667, 0.09605302820893584, 0.08786854081335574, 0.090640044677491, 0.09255691697524798], [0.08705124944558076, 0.09177875100329051, 0.08969573065530141, 0.09052125458055467, 0.08959477423245323, 0.09022784500620065, 0.09622143139923976, 0.08614958711094865, 0.09015917730563576, 0.09179793322797863], [0.08694601304383508, 0.09165336226082482, 0.08865581787325989, 0.08998378194048103, 0.0906611144340201, 0.08986126893020804, 0.09557258181139645, 0.08585787188407178, 0.08918447882539889, 0.090651880078215], [0.08695411418941358, 0.09165817804538928, 0.08865606635422663, 0.08998799084244602, 0.09067305163596122, 0.08985990159019977, 0.09557773109709826, 0.08585861315084804, 0.0891817240133414, 0.09065094012001543]]

CCLE_gCSI=[[0.09394801632348838, 0.08472016135429714, 0.09085563844761398, 0.0868127600280551, 0.09122573394349297, 0.08486829844401333, 0.08986135652944276, 0.08990011308785248, 0.09087211184578366, 0.08834195353298296], [0.09536215471663284, 0.08803228728015616, 0.09012450226875332, 0.08624082556608703, 0.0927504921482193, 0.0883511350548225, 0.09747984379377347, 0.08993649682024223, 0.09349291347413292, 0.08924312130883744], [0.10290337226580826, 0.09120148067670768, 0.09113355628797885, 0.09147214049382821, 0.09269138553768548, 0.09149792467831974, 0.10067859930985008, 0.09282941570267203, 0.09724363568350057, 0.09638723594409195], [0.10394530254651567, 0.09220247736004637, 0.09364826411716917, 0.09460868459205833, 0.09267106211578853, 0.09269467154034013, 0.10227789979281768, 0.09267875263013166, 0.09887380413144786, 0.09559130961583118], [0.10348528176254543, 0.09223059358152694, 0.09358854953315557, 0.09404098776570624, 0.09278845291420819, 0.09273817991008106, 0.10231546838024869, 0.09253320682357986, 0.09864694455448055, 0.09562485666110553]]
GDSC_gCSI= [[0.08724007390984982, 0.0909023726079502, 0.07498869908172742, 0.08148623927905667, 0.08614274335310587, 0.08037729812974871, 0.08232749258950034, 0.08402405024103918, 0.08530047117594006, 0.07867940855674523], [0.08696908432603723, 0.08896294744273522, 0.07384511399553999, 0.08057387946221857, 0.08589908306825336, 0.07969814235406661, 0.08127258835166735, 0.08309847612871676, 0.08524558266504982, 0.07780694619725724], [0.08552829240810973, 0.08824968682016218, 0.0740669577802701, 0.07980996546813228, 0.08527811025952504, 0.07871315194618018, 0.08104808775993749, 0.08245884093949636, 0.08352937747784461, 0.07703001256897705], [0.08378913854768508, 0.08773431120962191, 0.07315385385251476, 0.07937459814144159, 0.08418119624194752, 0.07757491341016007, 0.08029174736866188, 0.08212913650173317, 0.0829869889575749, 0.07614469938997567], [0.08379067090907578, 0.08774115488303423, 0.07315509908219545, 0.07938220261034375, 0.0841795070559512, 0.07757656419547433, 0.0802958475020725, 0.08213002851588548, 0.08300374160788844, 0.07614101205676604]]


methods={
        0:CCLE_GDSC,
        1:CCLE_gCSI,
        2:GDSC_gCSI,
        }

names={
        0:"CCLE-GDSC",
        1:"CCLE-gCSI",
        2:"GDSC-gCSI",
        }


# import pandas as pd
import numpy as np
import matplotlib.pyplot as plt



plt.style.use('ggplot')
plt.figure(figsize=(13,8))
plt.suptitle("MAE score comparison between different number of genes for different datasets")
for counter in range(len(methods)):
    ax = plt.subplot(1, 3, counter + 1)
    main=ax.boxplot(methods[counter], patch_artist=True)
    m = np.array(methods[counter]).mean(axis=1)
    st = np.array(methods[counter]).std(axis=1)
    ax.set_title(names[counter])
    for i, line in enumerate(main['medians']):
        x, y = line.get_xydata()[1]
        text = ' μ={:.4f}\n σ={:.4f}'.format(m[i], st[i])
        ax.annotate(text, xy=(x, y))
    ax.set_xticks([1, 2,3,4, 5])
    ax.set_xticklabels(["50 genes","100 genes", "200 genes", "500 genes",'902 genes'], rotation=20)
    # ax.set_ylim(-20,10)

    colors=["forestgreen", "blue", "dimgray",  "slategray", "tomato"]
     
    for patch, color in zip(main['boxes'],colors):
        patch.set_facecolor(color)
plt.tight_layout()
plt.savefig('Mae_our_method_all_dataset.png')
plt.show()

